@using MonitoringSystem.Data

@{
    string layoutMenu = ViewContext.HttpContext.Request.Cookies["layoutType"];
    string baseColor = "linear-gradient(109.6deg, rgb(61, 121, 176) 11.3%, rgb(35, 66, 164) 91.1%);";
    var title = ViewData["Title"] as string;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>@ViewData["Title"] - MonitoringSystem</title>

    <!-- CSS -->
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/lib/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="~/lib/bootstrap-icons/font/bootstrap-icons.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/sweetalert2.css" />

    <!-- Custom CSS - Refactored -->
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Sidebar.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Navbar.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/site-identity.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/MonitoringSystem.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/background-style.css?v=999" />

    <!-- JavaScript Libraries -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/chartjs/dist/chart.umd.js"></script>
</head>

<body class="reusable-bg">

    <!-- Header -->
    <header class="main-header">
        <div class="header-content">
            <div class="header-left">
                <img src="~/assets/PanasonicIcon.png" alt="Panasonic" />
            </div>
            <div class="header-center">
                <span>PANAM</span><span class="brand-o"></span><span>N</span>
            </div>
            <div class="header-right">
                <p id="current-date"></p>
                <p id="current-time"></p>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container-fluid p-0 d-flex" style="height: calc(100vh - 45px); margin-top:45px;">

        <!-- Sidebar -->
        <div id="bdSidebar" class="d-flex flex-column flex-shrink-0 text-white offcanvas-md offcanvas-start">
            <ul class="mynav nav nav-pills flex-column">
               <li class="nav-item">
    <a href="http://10.83.33.103:1111/">
        <i class="fa-solid fa-house"></i>
        <span class="nav-label">Home</span>
    </a>
</li>
                <li class="nav-item">
                    <a href="/Summary/index">
                        <i class="fa-solid fa-chart-pie"></i>
                        <span class="nav-label">Summary</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Perfomance/index">
                        <i class="fa-solid fa-chart-line"></i>
                        <span class="nav-label">Performance</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Quality/index">
                        <i class="fa-solid fa-check-circle"></i>
                        <span class="nav-label">Quality</span>
                    </a>
                </li>
                 <li class="nav-item">
                    <a href="/ProductionReport/index">
                        <i class="fa-solid fa-industry"></i>
                        <span class="nav-label">Production<br>Achievement</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/LossTimeReport/index">
                        <i class="fa-solid fa-arrow-trend-down"></i>
                        <span class="nav-label">Trend Loss<br>Time</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/LossTime/index">
                        <i class="fa-solid  fa-file-lines"></i>
                        <span class="nav-label">Detail Loss<br>Time</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#breakTimeFilterModal">
                        <i class="fa-solid fa-clock"></i>
                        <span class="nav-label">Break Time</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/Machine/index">
                        <i class="fa-solid fa-gear"></i>
                        <span class="nav-label">Machine</span>
                    </a>
                </li>

                <!-- MORE MENU -->
                <li class="nav-item" style="position: relative;">
                    <a href="#" id="moreMenuBtn">
                        <i class="fa-solid fa-ellipsis-vertical"></i>
                        <span class="nav-label">More</span>
                    </a>

                    <!-- POPUP MENU -->
                    <div id="moreMenuPopup">
                        <a href="/Summary/ProductionPlan">
                            <i class="fa-solid fa-clipboard-list"></i>
                            <span>Production<br>Plan</span>
                        </a>
                    </div>
                </li>
            </ul>

            <!-- Logout Section -->
            <div class="align-items-center center">
                <form method="post"
                      asp-area="Identity"
                      asp-page="/Account/Logout"
                      asp-route-returnUrl="@Url.Page("/Index", new { area = "" })">
                    <button type="submit" class="logout-btn">
                        <i class="fa-solid fa-right-from-bracket"></i>
                        <span class="nav-label">Log Out</span>
                    </button>
                </form>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content-wrapper">
            <div class="p-4">
                <main role="main" class="pb-2">
                    @RenderBody()
                </main>

    <!-- Footer -->
    <div class="footer-copyright text-white text-center">
        <p class="m-0 opacity-75">&copy; 2025 - Panasonic Manufacturing Indonesia (PMI) - AC BU</p>
    </div>
            </div>
        </div>
    </div>


    <!-- Break Time Filter Modal -->
    <div class="modal fade" id="breakTimeFilterModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-bottom border-secondary">
                    <h5 class="modal-title text-white fw-bold">
                        <i class="fa-solid fa-clock me-2"></i>Break Time Settings
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    @{
                        var models = new MonitoringSystem.Pages.Shared.ApplyBreakFilterModel(
                            (ApplicationDbContext)Context.RequestServices.GetService(typeof(ApplicationDbContext)));
                        await models.LoadBreakTimesAsync();
                        await Html.RenderPartialAsync("_BreakTimeFilterPartial", models);
                    }
                </div>
            </div>
        </div>
    </div>

  <!-- Validation Scripts - LOCAL -->
<script src="~/js/jquery.validate.min.js"></script>
<script src="~/js/jquery.validate.unobtrusive.min.js"></script>

    <!-- Custom Scripts -->
    <script src="~/js/layout.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
